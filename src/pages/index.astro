---
/**
 * Homepage
 * Main landing page for Kohaku Lab
 */

import Base from '../layouts/Base.astro';
import Navbar from '../components/Navbar.vue';
import Footer from '../components/Footer.vue';
import Hero from '../components/Hero.vue';
import ProjectCard from '../components/ProjectCard.vue';
import MemberCard from '../components/MemberCard.vue';
import BlogPostCard from '../components/BlogPostCard.vue';

import { projects, getFeaturedProjects } from '../config/projects.config.js';
import { members, getCoreMembers } from '../config/members.config.js';
import { heroStats, ctas } from '../config/site.config.js';
import { sortByDate } from '../utils/helpers.js';

// Get featured projects (first 3)
const featuredProjects = getFeaturedProjects().slice(0, 3);

// Get core team members (first 3)
const coreMembers = getCoreMembers().slice(0, 3);

// Get recent blog posts from markdown files
const allBlogPosts = await Astro.glob('../content/posts/*.md');
const sortedBlogPosts = sortByDate(allBlogPosts);
const recentPosts = sortedBlogPosts.slice(0, 3).map(post => ({
  title: post.frontmatter.title,
  description: post.frontmatter.description,
  pubDate: post.frontmatter.pubDate,
  thumbnail: post.frontmatter.thumbnail,
  tags: post.frontmatter.tags || [],
  author: post.frontmatter.author,
  slug: post.file.split('/').pop().replace('.md', ''),
  readingTime: post.frontmatter.readingTime,
}));
---

<Base>
  <!-- Navigation -->
  <Navbar slot="nav" client:load />

  <!-- Hero Section -->
  <Hero client:visible stats={heroStats} />

  <!-- Featured Projects Section -->
  <section class="section bg-slate-950/50">
    <div class="container-section">
      <div class="text-center mb-12">
        <h2 class="section-title">Featured Projects</h2>
        <p class="section-subtitle">
          Explore our latest open-source contributions to the AI/ML community
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        {featuredProjects.map(project => <ProjectCard client:visible project={project} />)}
      </div>

      <div class="text-center">
        <a href="/projects" class="btn-primary">
          <span class="i-carbon-folder"></span>
          <span>View All Projects</span>
        </a>
      </div>
    </div>
  </section>

  <!-- About Us Section -->
  <section class="section">
    <div class="container-section">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <!-- Content -->
        <div>
          <h2 class="section-title text-left">
            About <span class="gradient-text">Kohaku Lab</span>
          </h2>
          <div class="space-y-4 text-slate-300 leading-relaxed">
            <p>
              Kohaku Lab is a <strong class="text-white">virtual lab made by enthusiasts</strong> who
              build tools we actually want to use ourselves.
            </p>
            <p>
              We all use text-to-image models, so we trained HDM at home. We all used HuggingFace
              and Weights & Biases but got frustrated with their policy shifts, so we built
              KohakuHub and KohakuBoard. Simple as that - <strong class="text-white"
                >scratch your own itch</strong
              >.
            </p>
            <p>
              No grand mission. Just people building things they want to exist, sharing them openly,
              and having fun in the process. Everything we make is
              <strong class="text-white">100% open access</strong>.
            </p>
          </div>
          <div class="mt-8">
            <a href="/about" class="btn-secondary">
              <span>Learn More About Us</span>
              <span class="i-carbon-arrow-right"></span>
            </a>
          </div>
        </div>

        <!-- Key Points -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="card hover:border-blue-500/50 transition-colors">
            <div class="text-4xl mb-3">
              <span class="i-carbon-earth text-blue-400"></span>
            </div>
            <h3 class="text-lg font-semibold text-white mb-2">Virtual First</h3>
            <p class="text-slate-400 text-sm">Global collaboration without geographic boundaries</p>
          </div>

          <div class="card hover:border-blue-500/50 transition-colors">
            <div class="text-4xl mb-3">
              <span class="i-carbon-code text-green-400"></span>
            </div>
            <h3 class="text-lg font-semibold text-white mb-2">Open Access</h3>
            <p class="text-slate-400 text-sm">Everything we create is freely accessible to all</p>
          </div>

          <div class="card hover:border-blue-500/50 transition-colors">
            <div class="text-4xl mb-3">
              <span class="i-carbon-research text-purple-400"></span>
            </div>
            <h3 class="text-lg font-semibold text-white mb-2">Research Driven</h3>
            <p class="text-slate-400 text-sm">Pushing boundaries with innovative techniques</p>
          </div>

          <div class="card hover:border-blue-500/50 transition-colors">
            <div class="text-4xl mb-3">
              <span class="i-carbon-collaborate text-pink-400"></span>
            </div>
            <h3 class="text-lg font-semibold text-white mb-2">Community Focused</h3>
            <p class="text-slate-400 text-sm">Built by and for the AI/ML community</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Team Section -->
  <section class="section bg-slate-950/50">
    <div class="container-section">
      <div class="text-center mb-12">
        <h2 class="section-title">Meet Our Team</h2>
        <p class="section-subtitle">The passionate individuals behind Kohaku Lab</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        {coreMembers.map(member => <MemberCard client:visible member={member} />)}
      </div>

      <div class="text-center">
        <a href="/members" class="btn-primary">
          <span class="i-carbon-user-multiple"></span>
          <span>View All Members</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Recent Blog Posts Section -->
  <section class="section">
    <div class="container-section">
      <div class="text-center mb-12">
        <h2 class="section-title">Latest from Our Blog</h2>
        <p class="section-subtitle">Insights, tutorials, and updates from the Kohaku Lab team</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        {recentPosts.map(post => <BlogPostCard client:visible post={post} />)}
      </div>

      <div class="text-center">
        <a href="/blog" class="btn-primary">
          <span class="i-carbon-document"></span>
          <span>View All Posts</span>
        </a>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section
    class="section bg-gradient-to-br from-blue-900/30 to-purple-900/30 border-y border-blue-500/20"
  >
    <div class="container-narrow text-center">
      <h2 class="text-3xl sm:text-4xl font-bold text-white mb-4">{ctas.joinCommunity.title}</h2>
      <p class="text-lg text-slate-300 mb-8">
        {ctas.joinCommunity.description}
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href={ctas.joinCommunity.primaryButton.url}
          target="_blank"
          rel="noopener noreferrer"
          class="btn-primary"
        >
          <span class={ctas.joinCommunity.primaryButton.icon}></span>
          <span>{ctas.joinCommunity.primaryButton.text}</span>
        </a>
        <a href={ctas.joinCommunity.secondaryButton.url} class="btn-outline">
          <span class={ctas.joinCommunity.secondaryButton.icon}></span>
          <span>{ctas.joinCommunity.secondaryButton.text}</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <slot name="footer">
    <Footer client:load />
  </slot>
</Base>
